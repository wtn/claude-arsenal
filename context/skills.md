# Skills in Claude Arsenal

## What Are Skills?

Skills are domain-specific guidelines and best practices that Claude Code can reference during development. They provide focused, actionable guidance for specific domains, frameworks, or patterns.

## Two-Tier Skill Architecture

Claude Arsenal distributes skills via symlinks:

```
Gem Source:
  context/skills/ruby-gem-development/SKILL.md

Your Project:
  .context/claude-arsenal/skills/ruby-gem-development/  # Installed by agent-context
  .claude/skills/gems/ruby-gem-development              # Symlink
  .claude/skills/local/backend-api/                     # Real directory
```

**The flow:**
1. Gem ships with `context/skills/`
2. `bundle install` + `agent-context install` copies to `.context/`
3. `bake claude:arsenal:install` creates symlinks in `.claude/skills/gems/`
4. Claude Code discovers skills in `.claude/skills/` (both subdirectories)
5. `.gitignore` ignores `.context/` and `.claude/skills/gems/`

### Gem-Provided Skills (Symlinked from `.context/`)

**Four skills ship with the gem:**

| Skill | Type | Purpose |
|-------|------|---------|
| `ruby-gem-development` | domain | Gem best practices, module structure, Minitest |
| `generator-patterns` | domain | ERB templates, file generation, idempotency |
| `documentation-writing` | guidelines | 500-line rule, progressive disclosure |
| `test-coverage` | guardrail | Testing requirements (enforced) |

**Characteristics:**
- Zero duplication across projects
- Can be updated via `bundle update`
- Activation rules from YAML frontmatter
- Gitignored (regenerated by link_skills)
- Read-only (edit gem source, not symlink target)

**Location flow:**
```
Gem:        context/skills/ruby-gem-development/
Installed:  .context/claude-arsenal/skills/ruby-gem-development/
Symlinked:  .claude/skills/gems/ruby-gem-development
```

**Management commands:**
```bash
bake claude:arsenal:link_skills      # Create symlinks (auto-run during install)
bake claude:arsenal:unlink_skills    # Remove symlinks
```

### Project-Specific Skills (Local Files)

**Custom skills for your domain logic:**

**Examples:**
- `backend-api` - Your REST API conventions
- `frontend-components` - Your React/Vue component patterns
- `database-schema` - Your DB design rules
- `deployment` - Your deployment checklist

**Characteristics:**
- Real directories in `.claude/skills/local/`
- Committed to git
- Project-specific patterns
- Customizable per-project

**Creation:**
```bash
bake claude:arsenal:skill_create backend-api domain
```

**Location:**
```
.claude/skills/local/backend-api/
├── SKILL.md
└── resources/
```

### How They Coexist

Both types work identically in Claude Code:

1. **Discovery**: Claude Code scans `.claude/skills/gems/` and `.claude/skills/local/`
2. **Activation**: Both use `skill-rules.json` (gem rules auto-generated, project rules manual)
3. **Loading**: Claude Code reads the SKILL.md

**In skill-rules.json:**
```json
{
  "ruby-gem-development": {
    "type": "domain",
    "_linked": true,              // Marker: this is a symlink
    "_source": "claude-arsenal"   // Which gem provides it
  },
  "backend-api": {
    "type": "domain"
    // No _linked marker = real directory
  }
}
```

## The 500-Line Rule

**Best Practice**: Keep the main `SKILL.md` file under 500 lines.

Why 500 lines?
- Faster loading and processing
- Easier to maintain and update
- Forces clear, concise writing
- Better fits in Claude's context window

## Progressive Disclosure Pattern

Instead of cramming everything into `SKILL.md`, use this structure:

```
.claude/skills/
 backend-dev-guidelines/
     `SKILL.md`                  # < 500 lines, overview and quick reference
     resources/
         controllers.md          # Detailed controller patterns
         services.md             # Service layer guidelines
         repositories.md         # Data access patterns
         error-handling.md       # Comprehensive error handling
         testing.md              # Testing strategies
         examples.md             # Real-world examples
```

### What Goes in `SKILL.md`

1. **Purpose** - When and why to use this skill
2. **Core Principles** - 3-5 key principles with brief examples
3. **Quick Reference** - Common patterns and conventions
4. **Resource Index** - List of detailed resources
5. **Checklist** - Quick validation checklist

### What Goes in resources/

- Detailed implementation examples
- Edge cases and gotchas
- Performance considerations
- Migration guides
- Comprehensive troubleshooting

## Creating a Project-Specific Skill

**Note:** Gem skills (ruby-gem-development, generator-patterns, etc.) are already linked during install. Use this generator for project-specific patterns.

### Using the Generator

```bash
bake claude:arsenal:skill_create skill-name type
```

**Types:**
- `domain` - Domain-specific guidelines (e.g., backend-api, frontend-components)
- `guidelines` - General guidelines (e.g., code-review, deployment)
- `guardrail` - Safety checks and validation

**Example:**

```bash
bake claude:arsenal:skill_create backend-api domain
```

This creates a local skill in `.claude/skills/local/backend-api/`.

### Manual Creation

1. Create skill directory:
```bash
mkdir -p .claude/skills/local/my-skill/resources
```

2. Create `SKILL.md`:
```markdown
# My Skill

## Purpose
[Clear, concise purpose statement]

## When to Use
- [Use case 1]
- [Use case 2]

## Core Principles
### Principle 1
[Brief description with example]

## Resources
- `resources/detailed-guide.md` - Comprehensive guide
```

3. Add to skill-rules.json:
```json
{
  "my-skill": {
    "type": "domain",
    "enforcement": "suggest",
    "priority": "high",
    "promptTriggers": {
      "keywords": ["relevant", "keywords"],
      "intentPatterns": ["(create|add).*feature"]
    },
    "fileTriggers": {
      "pathPatterns": ["app/**/*.rb"],
      "contentPatterns": ["class.*Controller"]
    }
  }
}
```

## Skill Types

### Domain Skills

Focus on specific technical domains:
- Backend development patterns
- Frontend architecture
- Database design
- API development
- Authentication/authorization

**Characteristics:**
- Type: `domain`
- Enforcement: Usually `suggest`
- Priority: `high` for core domains, `medium` for specialized

### Guideline Skills

General best practices:
- Testing strategies
- Documentation standards
- Code review checklists
- Git workflow
- Performance optimization

**Characteristics:**
- Type: `guidelines`
- Enforcement: `suggest` or `require`
- Priority: `medium`

### Guardrail Skills

Safety and validation:
- Database migration safety
- Security checks
- Breaking change detection
- Deployment validation

**Characteristics:**
- Type: `guardrail`
- Enforcement: `require` or `block`
- Priority: `critical` or `high`

## Skill Activation

Skills activate automatically via the skill-activator hook based on:

### Prompt Triggers

**Keywords**: Simple word matching
```json
"keywords": ["backend", "controller", "API", "service"]
```

**Intent Patterns**: Regex for complex matching
```json
"intentPatterns": [
  "(create|add|implement).*?(route|endpoint|controller)",
  "(how to|best practice).*?(backend|API)"
]
```

### File Triggers

**Path Patterns**: Glob patterns for file paths
```json
"pathPatterns": [
  "app/**/*_controller.rb",
  "lib/services/**/*.rb"
]
```

**Content Patterns**: Regex for file content
```json
"contentPatterns": [
  "class.*Controller",
  "include.*Service"
]
```

## Enforcement Levels

### `suggest` (Default)

Shows a gentle reminder:
```
 Consider: Review skill "backend-dev" (.claude/skills/local/backend-dev/SKILL.md)
```

Use for:
- General best practices
- Domain guidelines
- Optional patterns

### `require`

Shows a strong warning:
```
  Required: Review skill "database-migrations" before proceeding
```

Use for:
- Important safety checks
- Critical patterns
- Team standards

### `block`

Prevents action (requires custom implementation):
```
�� BLOCKED: Must review "database-verification" skill before migration
```

Use for:
- Database operations in production
- Breaking changes
- Security-critical operations

## Priority Levels

Determines activation order when multiple skills match:

1. **`critical`** - Safety and security (guardrails)
2. **`high`** - Core domain knowledge
3. **`medium`** - General guidelines
4. **`low`** - Optional enhancements

## Best Practices

### Writing Skills

1. **Start with Why** - Explain when and why to use the skill
2. **Show, Don't Just Tell** - Include code examples
3. **One Concept Per Section** - Keep sections focused
4. **Link to Resources** - Don't duplicate, reference
5. **Use Checklists** - Make it actionable

### Organizing Skills

1. **One Domain Per Skill** - Don't mix concerns
2. **Progressive Disclosure** - Overview in `SKILL.md`, details in resources/
3. **Consistent Naming** - Use kebab-case: `backend-dev-guidelines`
4. **Clear Hierarchy** - Main skill  resources  examples

### Maintaining Skills

1. **Review Quarterly** - Keep content current
2. **Track Line Count** - Stay under 500 lines
3. **Update Examples** - Use current patterns
4. **Version Control** - Track changes in git
5. **Team Input** - Collaborative improvement

## Examples

### Simple Domain Skill

```markdown
# Backend Dev Guidelines

## Purpose
Provides patterns for Ruby backend development following our MVC architecture.

## Core Principles
### Routes  Controllers  Services  Repositories
Keep layers separate with clear responsibilities.

### Error Handling
Always use custom error classes with Sentry integration.

## Resources
- `resources/controllers.md` - Controller patterns
- `resources/services.md` - Service layer details
- `resources/errors.md` - Error handling examples
```

### Guardrail Skill

```markdown
# Database Migration Safety

## Purpose
Ensures safe database migrations in production.

## Required Checks
- [ ] Migration is reversible
- [ ] No data loss
- [ ] Tested on staging
- [ ] Downtime plan documented

## Dangerous Operations
  NEVER:
- Drop columns in use
- Change column types without migration path
- Remove indexes without analysis

## Resources
- `resources/safe-migrations.md` - Safe patterns
- `resources/zero-downtime.md` - Zero-downtime strategies
```

## Troubleshooting

### Skill Not Activating

1. Check skill-rules.json syntax
2. Verify keywords match your prompts
3. Test with exact keyword: "backend"
4. Check file path patterns

### Too Many Skills Activating

1. Make keywords more specific
2. Adjust priority levels
3. Use intent patterns instead of keywords
4. Review enforcement levels

### Skill File Too Large

1. Move detailed examples to resources/
2. Link instead of duplicating
3. Remove outdated content
4. Split into multiple focused skills

